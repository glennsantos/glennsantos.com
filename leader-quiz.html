<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Leader Self-Assessment Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-container {
            max-width: 800px;
        }
        .question-card {
            border-left: 4px solid #4f46e5;
        }
        .results-card {
            border-top: 8px solid #10b981;
        }
        /* Custom Slider Styles */
        .slider {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            background: #e5e7eb; /* gray-200 */
            outline: none;
            opacity: 0.8;
            transition: opacity .2s;
            border-radius: 9999px;
        }

        .slider:hover {
            opacity: 1;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4f46e5; /* indigo-600 */
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #4f46e5; /* indigo-600 */
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-8 form-container">
        
        <header class="bg-white rounded-lg shadow-md p-6 mb-8 border-t-8 border-indigo-600">
            <h1 class="text-3xl font-bold text-indigo-700">Engineering Leader Self-Assessment</h1>
            <p class="mt-2 text-gray-600">This self-assessment is designed to help you reflect on key leadership qualities. Rate yourself honestly on a scale from "Strongly Disagree" to "Strongly Agree" for each statement. Your total score will be computed at the end.</p>
        </header>

        <form id="leadershipQuiz">
            
            <!-- Category 1: Promotes Psychological Safety (Previously Positive Work Environment) -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-indigo-200">1. Promotes Psychological Safety</h2>
                <div class="bg-white rounded-lg shadow-md p-6 space-y-6 question-card">
                    <div class="question" data-category="env">
                        <p class="font-semibold text-lg mb-2">On my team, members feel safe to take calculated risks and discuss failures openly as learning opportunities.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q9" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                    <div class="question" data-category="env">
                        <p class="font-semibold text-lg mb-2">Team morale is consistently high, and issues like stress are addressed proactively and transparently.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q10" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category 2: Empowers Ownership (Previously Autonomy & Trust) -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-indigo-200">2. Empowers Ownership</h2>
                <div class="bg-white rounded-lg shadow-md p-6 space-y-6 question-card">
                    <div class="question" data-category="autonomy">
                        <p class="font-semibold text-lg mb-2">Engineers on my team have the autonomy to make decisions within their areas of ownership.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q7" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                    <div class="question" data-category="autonomy">
                        <p class="font-semibold text-lg mb-2">My management style focuses on results and impact, giving engineers space to determine their own implementation details.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q8" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category 3: Communicates Clearly (Previously Clear Communication & Strategic Alignment) -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-indigo-200">3. Communicates Clearly</h2>
                <div class="bg-white rounded-lg shadow-md p-6 space-y-6 question-card">
                    <div class="question" data-category="comm">
                        <p class="font-semibold text-lg mb-2">My team has a clear understanding of the technical direction and how it connects to our business objectives.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q5" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                    <div class="question" data-category="comm">
                        <p class="font-semibold text-lg mb-2">Team members can articulate how their individual work contributes to the company's broader goals.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q6" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Category 4: Cultivates Talent (Previously Growth & Development Support) -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-indigo-200">4. Cultivates Talent</h2>
                <div class="bg-white rounded-lg shadow-md p-6 space-y-6 question-card">
                    <div class="question" data-category="growth">
                        <p class="font-semibold text-lg mb-2">My team members are provided with clear opportunities and resources for professional growth and skill development.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q3" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                    <div class="question" data-category="growth">
                        <p class="font-semibold text-lg mb-2">My direct reports receive regular, helpful guidance regarding their career paths and development.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q4" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category 5: Shows Technical Credibility (Previously Technical Credibility) -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-indigo-200">5. Shows Technical Credibility</h2>
                <div class="bg-white rounded-lg shadow-md p-6 space-y-6 question-card">
                    <div class="question" data-category="tech">
                        <p class="font-semibold text-lg mb-2">My current technical knowledge allows me to effectively contribute to and guide system and architectural decisions.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q1" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                    <div class="question" data-category="tech">
                        <p class="font-semibold text-lg mb-2">I allocate my time between technical and management responsibilities in a way that best serves the team's needs.</p>
                        <div class="flex items-center space-x-4 rating-group pt-2">
                            <span class="text-sm text-gray-500 w-28 text-left">Strongly Disagree</span>
                            <input type="range" name="q2" min="1" max="7" value="4" class="w-full slider" required>
                            <span class="text-sm text-gray-500 w-28 text-right">Strongly Agree</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-center mt-8">
                <button type="submit" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition duration-300">
                    Calculate My Score
                </button>
            </div>
        </form>

        <div id="results" class="mt-10 hidden">
            <div class="bg-white rounded-lg shadow-lg p-8 results-card">
                <h2 class="text-3xl font-bold text-center text-green-600 mb-4">Your Results</h2>
                <div class="text-center">
                    <p class="text-xl text-gray-600">Your final score is:</p>
                    <p id="score" class="text-6xl font-extrabold text-indigo-600 my-4">0%</p>
                    <p id="fractionScore" class="text-base text-gray-400 mb-4"></p> <!-- Added fractional score display -->
                    <p id="feedback" class="text-lg text-gray-700 max-w-2xl mx-auto"></p>
                </div>
                
                <!-- Category Summary Container -->
                <div id="categorySummary" class="mt-8 pt-4 border-t border-gray-200">
                    <!-- Summary will be injected here by JavaScript -->
                </div>
                <!-- End Category Summary Container -->

                <div class="mt-8 text-center space-x-4">
                    <!-- New Share Button -->
                    <button onclick="shareResults()" id="shareButton" class="bg-indigo-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-400 transition duration-300">
                        Share My Results
                    </button>
                    <button onclick="retakeQuiz()" class="bg-gray-200 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 transition duration-300">
                        Retake Quiz
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.getElementById('leadershipQuiz').addEventListener('submit', function(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);
            
            // MAPPING: Old Question IDs to New Category Names
            const categoryMap = {
                // Category 1: Promotes Psychological Safety (q9, q10)
                'q9': 'Promotes Psychological Safety', 
                'q10': 'Promotes Psychological Safety',

                // Category 2: Empowers Ownership (q7, q8)
                'q7': 'Empowers Ownership', 
                'q8': 'Empowers Ownership',

                // Category 3: Communicates Clearly (q5, q6)
                'q5': 'Communicates Clearly', 
                'q6': 'Communicates Clearly',

                // Category 4: Cultivates Talent (q3, q4)
                'q3': 'Cultivates Talent', 
                'q4': 'Cultivates Talent',

                // Category 5: Shows Technical Credibility (q1, q2)
                'q1': 'Shows Technical Credibility', 
                'q2': 'Shows Technical Credibility'
            };

            // Initializing scores with New Category Names
            const categoryScores = {
                'Promotes Psychological Safety': 0,
                'Empowers Ownership': 0,
                'Communicates Clearly': 0,
                'Cultivates Talent': 0,
                'Shows Technical Credibility': 0
            };
            
            const maxPerCategory = 14; // 2 questions * 7 points
            let totalScore = 0;
            let questionCount = 0;

            // --- 1. Calculate Scores (Total and by Category) ---
            for (const [name, value] of formData.entries()) {
                const score = parseInt(value, 10);
                totalScore += score;
                questionCount++;

                const categoryName = categoryMap[name];
                if (categoryName) {
                    categoryScores[categoryName] += score;
                }
            }

            const maxScore = questionCount * 7; // 10 questions * 7 points
            const percentageScore = Math.round((totalScore / maxScore) * 100); // Calculate percentage

            // --- 2. Display Total Results and Feedback (Updated for percentage) ---
            document.getElementById('score').textContent = `${percentageScore}%`;
            document.getElementById('fractionScore').textContent = `(${totalScore} / ${maxScore} points)`;

            let feedbackText = '';
            
            if (totalScore >= 60) { // 60-70
                feedbackText = 'Excellent! Your self-assessment indicates a strong alignment with key engineering leadership qualities. You are likely creating a high-trust, high-impact environment. Keep reinforcing these positive behaviors.';
            } else if (totalScore >= 46) { // 46-59
                feedbackText = 'Very good! You have a solid foundation in many leadership areas. Identify the categories where you scored lower and consider focusing your development efforts there to become even more effective.';
            } else if (totalScore >= 32) { // 32-45
                feedbackText = 'Good starting point. Your results show an awareness of leadership principles, with clear opportunities for growth. Choose one or two key qualities to focus on improving over the next quarter.';
            } else { // 10-31
                feedbackText = 'This is a valuable baseline. This assessment has highlighted several areas for significant development. Focusing on fundamentals like building trust and clear communication will have a major impact on your team\'s success.';
            }

            document.getElementById('feedback').textContent = feedbackText;
            
            // --- 3. Generate and Inject Category Summary HTML ---
            let summaryHTML = '<h3 class="text-2xl font-semibold text-gray-700 mb-4">Category Breakdown</h3>';
            summaryHTML += '<div class="space-y-4">';

            // The order of the categories in the results is now determined by the order in categoryScores
            // Since JavaScript object keys maintain insertion order (ES2015+), the order is correct.
            for (const [category, score] of Object.entries(categoryScores)) {
                const percentage = Math.round((score / maxPerCategory) * 100);
                // Determine color based on score (Tailwind classes)
                let colorClass = 'bg-red-500'; // Low score
                if (percentage > 85) {
                    colorClass = 'bg-green-600'; // High score
                } else if (percentage > 60) {
                    colorClass = 'bg-yellow-500'; // Medium score
                }
                
                summaryHTML += `
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                        <p class="font-medium text-gray-700 sm:w-1/2">${category}</p>
                        <div class="sm:w-1/2 flex items-center mt-1 sm:mt-0">
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="h-3 rounded-full transition-all duration-500 ease-out ${colorClass}" style="width: ${percentage}%"></div>
                            </div>
                            <span class="ml-4 font-bold text-sm text-gray-800 w-16 text-right">${score}/${maxPerCategory}</span>
                        </div>
                    </div>
                `;
            }
            summaryHTML += '</div>';

            document.getElementById('categorySummary').innerHTML = summaryHTML;


            // --- 4. Show/Hide Elements ---
            document.getElementById('leadershipQuiz').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            window.scrollTo(0, document.body.scrollHeight);
        });

        // Function for Web Share API and Clipboard Fallback
        function shareResults() {
            const percentage = document.getElementById('score').textContent;
            const fractional = document.getElementById('fractionScore').textContent.match(/\((.*?)\)/)[1].trim(); // Extract (65 / 70 points)
            const quizTitle = document.title;
            // Using the link specified in the user request
            const quizLink = 'https://glennsantos.com/leader-quiz.html'; 
            
            if (navigator.share) {
                // Use Web Share API for native sharing
                navigator.share({
                    title: quizTitle,
                    text: `I just completed the ${quizTitle} and scored ${percentage}! My score was ${fractional}. Find out your score:`,
                    url: quizLink,
                }).catch((error) => {
                    // This often happens if the user cancels the share dialog
                    if (error.name !== 'AbortError') {
                        console.log('Error sharing:', error);
                    }
                });
            } else {
                // Fallback: Copy to clipboard
                const shareText = `My score on the Engineering Leader Self-Assessment is ${percentage} (${fractional}). Check out the quiz here: ${quizLink}`;
                
                // Create a temporary element to copy text
                const tempInput = document.createElement('textarea');
                tempInput.value = shareText;
                // Position off-screen
                tempInput.style.position = 'fixed'; 
                tempInput.style.opacity = '0';
                document.body.appendChild(tempInput);
                tempInput.select();
                
                try {
                    document.execCommand('copy');
                    
                    // Simple, non-intrusive notification
                    const notification = document.createElement('div');
                    notification.textContent = 'Score and link copied to clipboard!';
                    notification.className = 'fixed bottom-4 right-4 bg-indigo-600 text-white p-3 rounded-lg shadow-xl transition-opacity duration-300';
                    document.body.appendChild(notification);
                    setTimeout(() => notification.remove(), 3000);
                    
                } catch (err) {
                    console.error('Could not copy text: ', err);
                }
                document.body.removeChild(tempInput);
            }
        }

        function retakeQuiz() {
            document.getElementById('leadershipQuiz').reset();
            document.getElementById('leadershipQuiz').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            // Clear the summary before retaking
            document.getElementById('categorySummary').innerHTML = ''; 
            document.getElementById('fractionScore').textContent = ''; // Clear fractional score
            window.scrollTo(0, 0);
        }
    </script>

</body>
</html>
